<!DOCTYPE html>
<html>
<head>
<title>Server Sent Events</title>
<script type="text/javascript" src="js/ajax.js"></script>
<script type="text/javascript" src="js/ark.js"></script>
<script>

	function start() {
		if (typeof (EventSource) !== "undefined") {
			var source = new EventSource("NewDraw");
			
			source.addEventListener('lottery', function(event) {
				addItem(event.data);
			}, false);
			
			
		} else {
			document.getElementById("error").innerHTML = "Sorry, your browser does not support server-sent events...";
		}
	}

	function addItem(message) {
		var selectElement = document.getElementById("demo");
		var option = document.createElement("option");
		option.text = message;
		selectElement.add(option);
		selectElement.scrollTop = selectElement.scrollHeight - selectElement.clientHeight;
		
		var counterElement = document.getElementById("counter");
		var counter = parseInt(counterElement.innerHTML);
		counterElement.innerHTML = (counter + 1);
	}
</script>
</head>
<body>
	<h1>Server Sent Events + @Asynchronous EJB call demo</h1>
	<div id="error"></div>

	<div>
		<input type="button" value="Start" onclick="javascript: start();" />
	</div>

	<div id="counter">0</div>
	
	<select name="demo" id="demo" multiple="multiple"></select>
</body>
</html>